import{_ as p,r as e,o,c,a as n,b as s,d as l,e as a}from"./app-b3c70cc1.js";const i="/image/fiddler.png",u="/image/fiddler2.png",r={},k=a('<h1 id="æ›´å¤šåŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#æ›´å¤šåŠŸèƒ½" aria-hidden="true">#</a> æ›´å¤šåŠŸèƒ½</h1><h3 id="har-to-case" tabindex="-1"><a class="header-anchor" href="#har-to-case" aria-hidden="true">#</a> har to case</h3><p>å¯¹äºä¸ç†Ÿæ‚‰ Requests åº“çš„äººæ¥è¯´ï¼Œé€šè¿‡Seldomæ¥å†™æ¥å£æµ‹è¯•ç”¨ä¾‹è¿˜æ˜¯ä¼šæœ‰ä¸€ç‚¹éš¾åº¦ã€‚äºæ˜¯ï¼Œseldomæä¾›äº†<code>har</code> æ–‡ä»¶è½¬ <code>case</code> çš„å‘½ä»¤ã€‚</p><p>é¦–å…ˆï¼Œæ‰“å¼€fiddler å·¥å…·è¿›è¡ŒæŠ“åŒ…ï¼Œé€‰ä¸­æŸä¸€ä¸ªè¯·æ±‚ã€‚</p><p>ç„¶åï¼Œé€‰æ‹©èœå•æ ï¼š<code>file</code> -&gt; <code>Export Sessions</code> -&gt; <code>Selected Sessions...</code></p><p><img src="'+i+'" alt=""></p><p>é€‰æ‹©å¯¼å‡ºçš„æ–‡ä»¶æ ¼å¼ã€‚</p><p><img src="'+u+`" alt=""></p><p>ç‚¹å‡»<code>next</code> ä¿å­˜ä¸º<code>demo.har</code> æ–‡ä»¶ã€‚</p><p>æœ€åï¼Œé€šè¿‡<code>seldom -h2c</code> è½¬ä¸º<code>demo.py</code> è„šæœ¬æ–‡ä»¶ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> seldom <span class="token parameter variable">-h2c</span> demo.har

<span class="token number">2021</span>-06-14 <span class="token number">18</span>:05:50 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> Start to generate testcase.
<span class="token number">2021</span>-06-14 <span class="token number">18</span>:05:50 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> created file: D:<span class="token punctuation">\\</span>demo.py
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>demo.py</code> æ–‡ä»¶ã€‚</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> seldom


<span class="token keyword">class</span> <span class="token class-name">TestRequest</span><span class="token punctuation">(</span>seldom<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">&quot;http://httpbin.org/post&quot;</span>

    <span class="token keyword">def</span> <span class="token function">test_case</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;python-requests/2.25.0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Accept-Encoding&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;gzip, deflate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Accept&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Connection&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;keep-alive&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Host&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;httpbin.org&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Content-Length&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;36&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Origin&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://httpbin.org&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Cookie&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;lang=zh&quot;</span><span class="token punctuation">}</span>
        cookies <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;lang&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;zh&quot;</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>post<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">,</span> json<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;value1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;key2&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;value2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertStatusCode<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    seldom<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è¯·æ±‚è½¬-curl" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚è½¬-curl" aria-hidden="true">#</a> è¯·æ±‚è½¬ cURL</h3><p>seldom æ”¯æŒå°†è¯·æ±‚è½¬æˆ<code>cCURL</code>å‘½ä»¤ï¼Œ ä½ å¯ä»¥æ–¹ä¾¿çš„é€šè¿‡<code>cURL</code>å‘½ä»¤æ‰§è¡Œï¼Œæˆ–è€…å¯¼å…¥åˆ°å…¶ä»–æ¥å£å·¥å…·ï¼Œä¾‹å¦‚ï¼Œpostman æ”¯æŒ<code>cURL</code>å‘½ä»¤å¯¼å…¥ã€‚</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># test_http.py</span>
<span class="token keyword">import</span> seldom


<span class="token keyword">class</span> <span class="token class-name">TestRequest</span><span class="token punctuation">(</span>seldom<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    http api test demo
    doc: https://requests.readthedocs.io/en/master/
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">test_get_curl</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        test get curl
        &quot;&quot;&quot;</span>
        self<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;http://httpbin.org/get&#39;</span><span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        curl <span class="token operator">=</span> self<span class="token punctuation">.</span>curl<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>curl<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">&#39;http://httpbin.org/post&#39;</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        curl <span class="token operator">=</span> self<span class="token punctuation">.</span>curl<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>curl<span class="token punctuation">)</span>

        <span class="token comment"># or</span>
        r <span class="token operator">=</span> self<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token string">&#39;http://httpbin.org/delete&#39;</span><span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        curl <span class="token operator">=</span> self<span class="token punctuation">.</span>curl<span class="token punctuation">(</span>r<span class="token punctuation">.</span>request<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>curl<span class="token punctuation">)</span>
        r <span class="token operator">=</span> self<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">&#39;http://httpbin.org/put&#39;</span><span class="token punctuation">,</span> json<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;key&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        curl <span class="token operator">=</span> self<span class="token punctuation">.</span>curl<span class="token punctuation">(</span>r<span class="token punctuation">.</span>request<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>curl<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    seldom<span class="token punctuation">.</span>main<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ—¥å¿—ç»“æœ</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> python test_http.py

<span class="token punctuation">..</span>.
<span class="token function">curl</span> <span class="token parameter variable">-X</span> GET  <span class="token string">&#39;Content-Type: application/json&#39;</span>  <span class="token parameter variable">-H</span> <span class="token string">&#39;token: 123&#39;</span> <span class="token parameter variable">-d</span> <span class="token string">&#39;{&quot;key&quot;: &quot;value&quot;}&#39;</span> http://httpbin.org/get

<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST  <span class="token string">&#39;Content-Type: application/x-www-form-urlencoded&#39;</span> <span class="token parameter variable">-H</span>  <span class="token parameter variable">-d</span> <span class="token assign-left variable">key</span><span class="token operator">=</span>value http://httpbin.org/post

<span class="token function">curl</span> <span class="token parameter variable">-X</span> DELETE  <span class="token string">&#39;http://httpbin.org/delete?key=value&#39;</span>

<span class="token function">curl</span> <span class="token parameter variable">-X</span> PUT  <span class="token parameter variable">-H</span> <span class="token string">&#39;Content-Type: application/json&#39;</span> <span class="token parameter variable">-H</span> <span class="token string">&#39;token: 123&#39;</span> <span class="token parameter variable">-d</span> <span class="token string">&#39;{&quot;key&quot;: &quot;value&quot;}&#39;</span> http://httpbin.org/put
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¥å£æ•°æ®ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#æ¥å£æ•°æ®ä¾èµ–" aria-hidden="true">#</a> æ¥å£æ•°æ®ä¾èµ–</h3><p>åœ¨åœºæ™¯æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¸Šä¸€ä¸ªæ¥å£çš„æ•°æ®ï¼Œè°ƒç”¨ä¸‹ä¸€ä¸ªæ¥å£ã€‚</p><ul><li>ç®€å•çš„æ¥å£ä¾èµ–</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> seldom

<span class="token keyword">class</span> <span class="token class-name">TestRespData</span><span class="token punctuation">(</span>seldom<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">test_data_dependency</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Test for interface data dependencies
        &quot;&quot;&quot;</span>
        headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;X-Account-Fullname&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;bugmaster&quot;</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertStatusCode<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>

        username <span class="token operator">=</span> self<span class="token punctuation">.</span>response<span class="token punctuation">[</span><span class="token string">&quot;headers&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;X-Account-Fullname&quot;</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">&quot;/post&quot;</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">:</span> username<span class="token punctuation">}</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertStatusCode<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>seldomæä¾›äº†<code>self.response</code>ç”¨äºè®°å½•ä¸Šä¸ªæ¥å£è¿”å›çš„ç»“æœï¼Œç›´æ¥æ‹¿æ¥ç”¨å³å¯ã€‚</p><ul><li>å°è£…æ¥å£ä¾èµ–</li></ul><ol><li>åˆ›å»ºå…¬å…±æ¨¡å—</li></ol><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># common.py</span>
<span class="token keyword">from</span> seldom<span class="token punctuation">.</span>request <span class="token keyword">import</span> check_response 
<span class="token keyword">from</span> seldom<span class="token punctuation">.</span>request <span class="token keyword">import</span> HttpRequest


<span class="token keyword">class</span> <span class="token class-name">Common</span><span class="token punctuation">(</span>HttpRequest<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token decorator annotation punctuation">@check_response</span><span class="token punctuation">(</span>
        describe<span class="token operator">=</span><span class="token string">&quot;è·å–ç™»å½•ç”¨æˆ·å&quot;</span><span class="token punctuation">,</span>
        status_code<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
        ret<span class="token operator">=</span><span class="token string">&quot;headers.Account&quot;</span><span class="token punctuation">,</span>
        check<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;headers.Host&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;httpbin.org&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        debug<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get_login_user</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        è°ƒç”¨æ¥å£è·å¾—ç”¨æˆ·å
        &quot;&quot;&quot;</span>
        headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;Account&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;bugmaster&quot;</span><span class="token punctuation">}</span>
        r <span class="token operator">=</span> self<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org/get&quot;</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
        <span class="token keyword">return</span> r


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    c <span class="token operator">=</span> Common<span class="token punctuation">(</span><span class="token punctuation">)</span>
    c<span class="token punctuation">.</span>get_login_user<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿è¡Œæ—¥å¿—</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:48 request.py <span class="token operator">|</span> DEBUG <span class="token operator">|</span> Execute get_login_user - args: <span class="token punctuation">(</span><span class="token operator">&lt;</span>__main__.Common object at 0x000002326307510<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>,<span class="token punctuation">)</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:48 request.py <span class="token operator">|</span> DEBUG <span class="token operator">|</span> Execute get_login_user - kwargs: <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:48 request.py <span class="token operator">|</span> INFO <span class="token operator">|</span> -------------- Request -----------------<span class="token punctuation">[</span>ğŸš€<span class="token punctuation">]</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:48 request.py <span class="token operator">|</span> INFO <span class="token operator">|</span> <span class="token punctuation">[</span>method<span class="token punctuation">]</span>: GET      <span class="token punctuation">[</span>url<span class="token punctuation">]</span>: http://httpbin.org/get
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:48 request.py <span class="token operator">|</span> DEBUG <span class="token operator">|</span> <span class="token punctuation">[</span>headers<span class="token punctuation">]</span>:
 <span class="token punctuation">{</span>
  <span class="token string">&quot;Account&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bugmaster&quot;</span>
<span class="token punctuation">}</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:49 request.py <span class="token operator">|</span> INFO <span class="token operator">|</span> -------------- Response ----------------<span class="token punctuation">[</span>ğŸ›¬ï¸<span class="token punctuation">]</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:49 request.py <span class="token operator">|</span> INFO <span class="token operator">|</span> successful with status <span class="token number">200</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:49 request.py <span class="token operator">|</span> DEBUG <span class="token operator">|</span> <span class="token punctuation">[</span>type<span class="token punctuation">]</span>: json      <span class="token punctuation">[</span>time<span class="token punctuation">]</span>: <span class="token number">0.601097</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:49 request.py <span class="token operator">|</span> DEBUG <span class="token operator">|</span> <span class="token punctuation">[</span>response<span class="token punctuation">]</span>:
 <span class="token punctuation">{</span>
  <span class="token string">&quot;args&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
  <span class="token string">&quot;headers&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;Accept&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;*/*&quot;</span>,
    <span class="token string">&quot;Accept-Encoding&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;gzip, deflate&quot;</span>,
    <span class="token string">&quot;Account&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bugmaster&quot;</span>,
    <span class="token string">&quot;Host&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;httpbin.org&quot;</span>,
    <span class="token string">&quot;User-Agent&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;python-requests/2.28.1&quot;</span>,
    <span class="token string">&quot;X-Amzn-Trace-Id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Root=1-63ebae14-1e629b132c21f68e23ffeb33&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;origin&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;173.248.248.88&quot;</span>,
  <span class="token string">&quot;url&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;http://httpbin.org/get&quot;</span>
<span class="token punctuation">}</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:49 request.py <span class="token operator">|</span> DEBUG <span class="token operator">|</span> Execute get_login_user - response:
 <span class="token punctuation">{</span><span class="token string">&#39;args&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>, <span class="token string">&#39;headers&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;Accept&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;*/*&#39;</span>, <span class="token string">&#39;Accept-Encoding&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;gzip, deflate&#39;</span>, <span class="token string">&#39;Account&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;bugmaster&#39;</span>, <span class="token string">&#39;Host&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;httpbin.org&#39;</span>, <span class="token string">&#39;User-Agent&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;python-requests/2.28.1&#39;</span>, <span class="token string">&#39;X-Amzn-Trace-Id&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;Root=1-63ebae14-1e629b132c21f68e23ffeb33&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;origin&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;173.248.248.88&#39;</span>, <span class="token string">&#39;url&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;http://httpbin.org/get&#39;</span><span class="token punctuation">}</span>
<span class="token number">2023</span>-02-14 <span class="token number">23</span>:51:49 request.py <span class="token operator">|</span> INFO <span class="token operator">|</span> Execute get_login_user - è·å–ç™»å½•ç”¨æˆ·å success<span class="token operator">!</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>@check_response</code> ä¸“é—¨ç”¨äºå¤„ç†å°è£…çš„æ–¹æ³•ã€‚</p><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><code>describe</code> : å°è£…æ–¹æ³•æè¿°ã€‚</li><li><code>status_code</code>: åˆ¤æ–­æ¥å£è¿”å›çš„ HTTP çŠ¶æ€ç ï¼Œé»˜è®¤<code>200</code>ã€‚</li><li><code>ret</code>: æå–æ¥å£è¿”å›çš„å­—æ®µï¼Œå‚è€ƒ<code>jmespath</code> æå–è§„åˆ™ã€‚</li><li><code>check</code>: æ£€æŸ¥æ¥å£è¿”å›çš„å­—æ®µã€‚å‚è€ƒ<code>jmespath</code> æå–è§„åˆ™ã€‚</li><li><code>debug</code>: å¼€å¯<code>debug</code>ï¼Œæ‰“å°æ›´å¤šä¿¡æ¯ã€‚</li></ul><ol start="2"><li>å¼•ç”¨å…¬å…±æ¨¡å—</li></ol><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> seldom
<span class="token keyword">from</span> common <span class="token keyword">import</span> Common


<span class="token keyword">class</span> <span class="token class-name">TestRequest</span><span class="token punctuation">(</span>seldom<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>c <span class="token operator">=</span> Common<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_case</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># è°ƒç”¨ get_login_user() è·å–</span>
        user <span class="token operator">=</span> self<span class="token punctuation">.</span>c<span class="token punctuation">.</span>get_login_user<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org/post&quot;</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">:</span> user<span class="token punctuation">}</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertStatusCode<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    seldom<span class="token punctuation">.</span>main<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sessionä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#sessionä½¿ç”¨" aria-hidden="true">#</a> Sessionä½¿ç”¨</h3><p>åœ¨å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œå¤§éƒ¨åˆ†æ¥å£éœ€è¦ç™»å½•ï¼Œ<code>Session</code> æ˜¯ä¸€ç§éå¸¸ç®€å•è®°å½•ç™»å½•çŠ¶æ€çš„æ–¹å¼ã€‚</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> seldom


<span class="token keyword">class</span> <span class="token class-name">TestCase</span><span class="token punctuation">(</span>seldom<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>s <span class="token operator">=</span> self<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;/cookies/set/sessioncookie/123456789&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_get_cookie1</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;/cookies&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_get_cookie2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;/cookies&#39;</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    seldom<span class="token punctuation">.</span>main<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> base_url<span class="token operator">=</span><span class="token string">&quot;https://httpbin.org&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”¨æ³•éå¸¸ç®€å•ï¼Œä½ åªéœ€è¦åœ¨æ¯ä¸ªæ¥å£ä¹‹å‰è°ƒç”¨ä¸€æ¬¡<code>ç™»å½•</code>ï¼Œ <code>self.s</code>å¯¹è±¡å°±è®°å½•ä¸‹äº†ç™»å½•çŠ¶æ€ï¼Œé€šè¿‡<code>self.s</code> å†å»è°ƒç”¨å…¶ä»–æ¥å£å°±ä¸éœ€è¦ç™»å½•ã€‚</p><h3 id="æå–æ¥å£è¿”å›æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æå–æ¥å£è¿”å›æ•°æ®" aria-hidden="true">#</a> æå–æ¥å£è¿”å›æ•°æ®</h3><p>å½“æ¥å£è¿”å›çš„æ•°æ®æ¯”è¾ƒå¤æ‚æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æœ‰æ›´æ–¹ä¾¿æ–¹å¼å»æå–æ•°æ®ï¼Œseldomæä¾› <code>jmespath</code>ã€<code>jsonpath</code> æ¥ç®€åŒ–æ•°æ®æå–ã€‚</p><ul><li>æ¥å£è¿”å›æ•°æ®</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;hobby&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;basketball&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;swim&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tom&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;headers&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Accept&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*/*&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Accept-Encoding&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gzip, deflate&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;httpbin.org&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;User-Agent&quot;</span><span class="token operator">:</span> <span class="token string">&quot;python-requests/2.25.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;X-Amzn-Trace-Id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Root=1-62851614-1ca9fdb276238c60406c118f&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;origin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;113.87.15.99&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://httpbin.org/get?name=tom&amp;hobby=basketball&amp;hobby=swim&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¸¸è§„æå–</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> seldom


<span class="token keyword">class</span> <span class="token class-name">TestAPI</span><span class="token punctuation">(</span>seldom<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">test_extract_responses</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        æå– response æ•°æ®
        &quot;&quot;&quot;</span>
        payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;hobby&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;basketball&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;swim&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;tom&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org/get&quot;</span><span class="token punctuation">,</span> params<span class="token operator">=</span>payload<span class="token punctuation">)</span>

        <span class="token comment"># response</span>
        response1 <span class="token operator">=</span> self<span class="token punctuation">.</span>response<span class="token punctuation">[</span><span class="token string">&quot;args&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span>
        response2 <span class="token operator">=</span> self<span class="token punctuation">.</span>response<span class="token punctuation">[</span><span class="token string">&quot;args&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;hobby&quot;</span><span class="token punctuation">]</span>
        response3 <span class="token operator">=</span> self<span class="token punctuation">.</span>response<span class="token punctuation">[</span><span class="token string">&quot;args&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;hobby&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;response1 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>response1<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;response2 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>response2<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;response3 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>response3<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

        <span class="token comment"># jmespath</span>
        jmespath1 <span class="token operator">=</span> self<span class="token punctuation">.</span>jmespath<span class="token punctuation">(</span><span class="token string">&quot;args.name&quot;</span><span class="token punctuation">)</span>
        jmespath2 <span class="token operator">=</span> self<span class="token punctuation">.</span>jmespath<span class="token punctuation">(</span><span class="token string">&quot;args.hobby&quot;</span><span class="token punctuation">)</span>
        jmespath3 <span class="token operator">=</span> self<span class="token punctuation">.</span>jmespath<span class="token punctuation">(</span><span class="token string">&quot;args.hobby[0]&quot;</span><span class="token punctuation">)</span>
        jmespath4 <span class="token operator">=</span> self<span class="token punctuation">.</span>jmespath<span class="token punctuation">(</span><span class="token string">&quot;hobby[0]&quot;</span><span class="token punctuation">,</span> response<span class="token operator">=</span>self<span class="token punctuation">.</span>response<span class="token punctuation">[</span><span class="token string">&quot;args&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\\njmespath1 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jmespath1<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;jmespath2 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jmespath2<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;jmespath3 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jmespath3<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;jmespath4 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jmespath4<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

        <span class="token comment"># jsonpath</span>
        jsonpath1 <span class="token operator">=</span> self<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span><span class="token string">&quot;$..name&quot;</span><span class="token punctuation">)</span>
        jsonpath2 <span class="token operator">=</span> self<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span><span class="token string">&quot;$..hobby&quot;</span><span class="token punctuation">)</span>
        jsonpath3 <span class="token operator">=</span> self<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span><span class="token string">&quot;$..hobby[0]&quot;</span><span class="token punctuation">)</span>
        jsonpath4 <span class="token operator">=</span> self<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span><span class="token string">&quot;$..hobby[0]&quot;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
        jsonpath5 <span class="token operator">=</span> self<span class="token punctuation">.</span>jsonpath<span class="token punctuation">(</span><span class="token string">&quot;$..hobby[0]&quot;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> response<span class="token operator">=</span>self<span class="token punctuation">.</span>response<span class="token punctuation">[</span><span class="token string">&quot;args&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\\njsonpath1 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jsonpath1<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;jsonpath2 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jsonpath2<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;jsonpath3 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jsonpath3<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;jsonpath4 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jsonpath4<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;jsonpath5 --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>jsonpath5<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯´æ˜ï¼š</p><ul><li><code>response</code>: ä¿å­˜æ¥å£è¿”å›çš„æ•°æ®ï¼Œå¯ä»¥ç›´æ¥ä»¥ï¼Œå­—å…¸åˆ—è¡¨çš„æ–¹å¼æå–ã€‚</li><li><code>jmespath()</code>: æ ¹æ® JMESPath è¯­æ³•è§„åˆ™ï¼Œé»˜è®¤æå–æ¥å£è¿”å›çš„æ•°æ®ï¼Œä¹Ÿå¯æŒ‡å®š<code>resposne</code>æ•°æ®æå–ã€‚</li><li><code>jsonpath()</code>: æ ¹æ® JsonPath è¯­æ³•è§„åˆ™ï¼Œé»˜è®¤æå–æ¥å£è¿”å›çš„æ•°æ®, <code>index</code>æŒ‡å®šä¸‹æ ‡ï¼Œä¹Ÿå¯æŒ‡å®š<code>resposne</code>æ•°æ®æå–ã€‚</li></ul><p>è¿è¡Œç»“æœï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">2022</span>-05-19 00:57:08 log.py <span class="token operator">|</span> DEBUG <span class="token operator">|</span> <span class="token punctuation">[</span>response<span class="token punctuation">]</span>:
 <span class="token punctuation">{</span><span class="token string">&#39;args&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;age&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;18&#39;</span>, <span class="token string">&#39;hobby&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#39;basketball&#39;</span>, <span class="token string">&#39;swim&#39;</span><span class="token punctuation">]</span>, <span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;tom&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;headers&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;Accept&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;*/*&#39;</span>, <span class="token string">&#39;Accept-Encoding&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;gzip, deflate&#39;</span>, <span class="token string">&#39;Host&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;httpbin.org&#39;</span>, <span class="token string">&#39;User-Agent&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;python-requests/2.25.0&#39;</span>, <span class="token string">&#39;X-Amzn-Trace-Id&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;Root=1-62852563-2fe77d4b1ce544696af60f10&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;origin&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;113.87.15.99&#39;</span>, <span class="token string">&#39;url&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;http://httpbin.org/get?hobby=basketball&amp;hobby=swim&amp;name=tom&amp;age=18&#39;</span><span class="token punctuation">}</span>

response1 --<span class="token operator">&gt;</span> tom
response2 --<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token string">&#39;basketball&#39;</span>, <span class="token string">&#39;swim&#39;</span><span class="token punctuation">]</span>
response3 --<span class="token operator">&gt;</span> basketball

jmespath1 --<span class="token operator">&gt;</span> tom
jmespath2 --<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token string">&#39;basketball&#39;</span>, <span class="token string">&#39;swim&#39;</span><span class="token punctuation">]</span>
jmespath3 --<span class="token operator">&gt;</span> basketball
jmespath4 --<span class="token operator">&gt;</span> basketball

jsonpath1 --<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token string">&#39;tom&#39;</span><span class="token punctuation">]</span>
jsonpath2 --<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;basketball&#39;</span>, <span class="token string">&#39;swim&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
jsonpath3 --<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token string">&#39;basketball&#39;</span><span class="token punctuation">]</span>
jsonpath4 --<span class="token operator">&gt;</span> basketball
jsonpath5 --<span class="token operator">&gt;</span> basketball
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œç»“æœ</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">..</span>.
<span class="token number">2022</span>-04-10 <span class="token number">21</span>:05:17.683 <span class="token operator">|</span> DEBUG    <span class="token operator">|</span> seldom.logging.log:debug:34 - <span class="token punctuation">[</span>response<span class="token punctuation">]</span>:
 <span class="token punctuation">{</span><span class="token string">&#39;args&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;age&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;18&#39;</span>, <span class="token string">&#39;hobby&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#39;basketball&#39;</span>, <span class="token string">&#39;swim&#39;</span><span class="token punctuation">]</span>, <span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;tom&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;headers&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;Accept&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;*/*&#39;</span>, <span class="token string">&#39;Accept-Encoding&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;gzip, deflate&#39;</span>, <span class="token string">&#39;Host&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;httpbin.org&#39;</span>, <span class="token string">&#39;User-Agent&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;python-requests/2.25.0&#39;</span>, <span class="token string">&#39;X-Amzn-Trace-Id&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;Root=1-6252d60c-551433d744b6869e5d1944d7&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;origin&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;113.87.12.14&#39;</span>, <span class="token string">&#39;url&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;http://httpbin.org/get?hobby=basketball&amp;hobby=swim&amp;name=tom&amp;age=18&#39;</span><span class="token punctuation">}</span>

<span class="token number">2022</span>-04-10 <span class="token number">21</span>:05:17.686 <span class="token operator">|</span> DEBUG    <span class="token operator">|</span> seldom.logging.log:debug:34 - <span class="token punctuation">[</span>jresponse<span class="token punctuation">]</span>:
 <span class="token punctuation">[</span><span class="token string">&#39;basketball&#39;</span><span class="token punctuation">]</span>
<span class="token number">2022</span>-04-10 <span class="token number">21</span>:05:17.689 <span class="token operator">|</span> DEBUG    <span class="token operator">|</span> seldom.logging.log:debug:34 - <span class="token punctuation">[</span>jresponse<span class="token punctuation">]</span>:
 <span class="token punctuation">[</span><span class="token string">&#39;18&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="genson" tabindex="-1"><a class="header-anchor" href="#genson" aria-hidden="true">#</a> genson</h3>`,50),d=n("code",null,"assertSchema()",-1),m={href:"https://github.com/wolverdude/GenSON",target:"_blank",rel:"noopener noreferrer"},v=a(`<ul><li>ä¾‹å­</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> seldom
<span class="token keyword">from</span> seldom<span class="token punctuation">.</span>utils <span class="token keyword">import</span> genson


<span class="token keyword">class</span> <span class="token class-name">TestAPI</span><span class="token punctuation">(</span>seldom<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">test_assert_schema</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;hobby&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;basketball&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;swim&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;tom&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">,</span> params<span class="token operator">=</span>payload<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;response \\n&quot;</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>response<span class="token punctuation">)</span>
        
        schema <span class="token operator">=</span> genson<span class="token punctuation">(</span>self<span class="token punctuation">.</span>response<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;json Schema \\n&quot;</span><span class="token punctuation">,</span> schema<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>assertSchema<span class="token punctuation">(</span>schema<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿è¡Œæ—¥å¿—</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">..</span>.
response
 <span class="token punctuation">{</span><span class="token string">&#39;args&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;age&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;18&#39;</span>, <span class="token string">&#39;hobby&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#39;basketball&#39;</span>, <span class="token string">&#39;swim&#39;</span><span class="token punctuation">]</span>, <span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;tom&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;headers&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;Accept&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;*/*&#39;</span>, <span class="token string">&#39;Accept-Encoding&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;gzip, deflate&#39;</span>, <span class="token string">&#39;Host&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;httpbin.org&#39;</span>, <span class="token string">&#39;User-Agent&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;python-requests/2.25.0&#39;</span>, <span class="token string">&#39;X-Amzn-Trace-Id&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;Root=1-626574d0-4c04bb7e76a53e8042c9d856&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;origin&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;173.248.248.88&#39;</span>, <span class="token string">&#39;url&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;http://httpbin.org/get?hobby=basketball&amp;hobby=swim&amp;name=tom&amp;age=18&#39;</span><span class="token punctuation">}</span>

json Schema
 <span class="token punctuation">{</span><span class="token string">&#39;$schema&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;http://json-schema.org/schema#&#39;</span>, <span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;object&#39;</span>, <span class="token string">&#39;properties&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;args&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;object&#39;</span>, <span class="token string">&#39;properties&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;age&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;hobby&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;array&#39;</span>, <span class="token string">&#39;items&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>, <span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>, <span class="token string">&#39;required&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span>, <span class="token string">&#39;hobby&#39;</span>, <span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>, <span class="token string">&#39;headers&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;object&#39;</span>, <span class="token string">&#39;properties&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;Accept&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;Accept-Encoding&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;Host&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;User-Agent&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;X-Amzn-Trace-Id&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>, <span class="token string">&#39;required&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Accept&#39;</span>, <span class="token string">&#39;Accept-Encoding&#39;</span>, <span class="token string">&#39;Host&#39;</span>, <span class="token string">&#39;User-Agent&#39;</span>, <span class="token string">&#39;X-Amzn-Trace-Id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>, <span class="token string">&#39;origin&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span>, <span class="token string">&#39;url&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>, <span class="token string">&#39;required&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#39;args&#39;</span>, <span class="token string">&#39;headers&#39;</span>, <span class="token string">&#39;origin&#39;</span>, <span class="token string">&#39;url&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="mock-url" tabindex="-1"><a class="header-anchor" href="#mock-url" aria-hidden="true">#</a> mock URL</h3><blockquote><p>seldom 3.2.3 æ”¯æŒ</p></blockquote><p>seldom è¿è¡Œå…è®¸é€šè¿‡<code>confrun.py</code>æ–‡ä»¶ä¸­<code>mock_url()</code> é…ç½®mock URLæ˜ å°„ã€‚</p><ul><li>confrun.py</li></ul><p>é…ç½®è¦æ˜ å°„çš„mock URLã€‚</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">def</span> <span class="token function">mock_url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;

    :return:
    &quot;&quot;&quot;</span>
    config <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;http://httpbin.org/get&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8000/api/data&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>test_api.py</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> seldom


<span class="token keyword">class</span> <span class="token class-name">TestRequest</span><span class="token punctuation">(</span>seldom<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    http api test demo
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">test_get_method</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;key1&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;value1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;key2&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;value2&#39;</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">,</span> params<span class="token operator">=</span>payload<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertStatusCode<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    seldom<span class="token punctuation">.</span>main<span class="token punctuation">(</span>base_url<span class="token operator">=</span><span class="token string">&quot;http://httpbin.org&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿è¡Œ</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> python test_api.py

<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> INFO     <span class="token operator">|</span> request.py <span class="token operator">|</span> -------------- Request -----------------<span class="token punctuation">[</span>ğŸš€<span class="token punctuation">]</span>
<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> INFO     <span class="token operator">|</span> request.py <span class="token operator">|</span> <span class="token punctuation">[</span>method<span class="token punctuation">]</span>: GET      <span class="token punctuation">[</span>url<span class="token punctuation">]</span>: http://httpbin.org/get
<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> DEBUG    <span class="token operator">|</span> request.py <span class="token operator">|</span> <span class="token punctuation">[</span>params<span class="token punctuation">]</span>:
<span class="token punctuation">{</span>
  <span class="token string">&quot;key1&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;value1&quot;</span>,
  <span class="token string">&quot;key2&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;value2&quot;</span>
<span class="token punctuation">}</span>
<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> DEBUG    <span class="token operator">|</span> request.py <span class="token operator">|</span> mock url: http://127.0.0.1:8000/api/data
<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> INFO     <span class="token operator">|</span> request.py <span class="token operator">|</span> -------------- Response ----------------<span class="token punctuation">[</span>ğŸ›¬ï¸<span class="token punctuation">]</span>
<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> INFO     <span class="token operator">|</span> request.py <span class="token operator">|</span> successful with status <span class="token number">200</span>
<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> DEBUG    <span class="token operator">|</span> request.py <span class="token operator">|</span> <span class="token punctuation">[</span>type<span class="token punctuation">]</span>: json      <span class="token punctuation">[</span>time<span class="token punctuation">]</span>: <span class="token number">0.002738</span>
<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> DEBUG    <span class="token operator">|</span> request.py <span class="token operator">|</span> <span class="token punctuation">[</span>response<span class="token punctuation">]</span>:
 <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&#39;item_name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;apple&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;item_name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;banana&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;item_name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;orange&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;item_name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;watermelon&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;item_name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;grape&#39;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token number">2023</span>-07-30 <span class="token number">14</span>:47:08 <span class="token operator">|</span> INFO     <span class="token operator">|</span> case.py <span class="token operator">|</span> ğŸ‘€ assertStatusCode -<span class="token operator">&gt;</span> <span class="token number">200</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æ—¥å¿—å¯ä»¥çœ‹åˆ° <code>http://httpbin.org/get</code> æ›¿æ¢æˆä¸º <code>http://127.0.0.1:8000/api/data</code> æ‰§è¡Œã€‚ å½“ä½ ä¸æƒ³mockçš„æ—¶å€™åªéœ€è¦ä¿®æ”¹ mock_url() å³å¯ï¼Œå¯¹äºç”¨ä¾‹æ¥è¯´æ— å½±å“ã€‚</p>`,15);function b(g,q){const t=e("ExternalLinkIcon");return o(),c("div",null,[k,n("p",null,[s("é€šè¿‡ "),d,s(" æ–­è¨€æ—¶éœ€è¦å†™JSON Schemaï¼Œä½†æ˜¯è¿™ä¸ªå†™èµ·æ¥éœ€è¦å­¦ä¹ æˆæœ¬ï¼Œseldomé›†æˆäº†"),n("a",m,[s("GenSON"),l(t)]),s(" ,å¯ä»¥å¸®ä½ è‡ªåŠ¨ç”Ÿæˆã€‚")]),v])}const y=p(r,[["render",b],["__file","more.html.vue"]]);export{y as default};
